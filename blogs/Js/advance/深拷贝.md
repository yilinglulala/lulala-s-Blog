---
title: æ·±æ‹·è´
date: 2021-04-11
tags:

categories: 
 - Js

---

## JSON.parse(JSON.stringify(object))

åªèƒ½é€‚ç”¨äºç®€å•çš„å¼•ç”¨ç±»å‹ï¼Œ``function,regexpr`` ç­‰æ— æ³•å¤åˆ¶

## ğŸ˜•é€’å½’

```js
// åˆ©ç”¨ WeakMap è§£å†³å¾ªç¯å¼•ç”¨
let map = new WeakMap()
function deepClone(obj) {
  if (obj instanceof Object) {
    if (map.has(obj)) {
      return map.get(obj)
    }
    let newObj
    if (obj instanceof Array) {
      newObj = []     
    } else if (obj instanceof Function) {
      newObj = function() {
        return obj.apply(this, arguments)
      }
    } else if (obj instanceof RegExp) {
      // æ‹¼æ¥æ­£åˆ™
      newobj = new RegExp(obj.source, obj.flags)
    } else if (obj instanceof Date) {
      newobj = new Date(obj)
    } else {
      newObj = {}
    }
    // å…‹éš†ä¸€ä»½å¯¹è±¡å‡ºæ¥
    let desc = Object.getOwnPropertyDescriptors(obj)
    let clone = Object.create(Object.getPrototypeOf(obj), desc)
    map.set(obj, clone)
    for (let key in obj) {
      if (obj.hasOwnProperty(key)) {
        newObj[key] = deepClone(obj[key])
      }
    }
    return newObj
  }
  return obj
}
```

