## 根据IP分配请求节点

**问题：**

ysmp 独立部署在集群场景下登录后马上退登

**分析：**

集群情况下，ysmp独立部署没有redis, 请求随机打到三个节点上，节点1登录之后发起的请求如果打到节点2 上就会鉴权失败

因为节点2 上拿不到登录的session信息，就会鉴权失败

**解决方法：**

IP绑定 ip_hash

每个请求按访问ip 的hash 结果分配，这样每个访客固定访问一个后端服务器，可以解决session 问题

```nginx
upstream backserver{
ip_hash;
server 192.168.0.14:88;
server 192.168.0.15:80;
}
```



