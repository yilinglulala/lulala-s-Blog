## æ‰‹å†™promise

[BATå‰ç«¯ç»å…¸é¢è¯•é—®é¢˜ï¼šå²ä¸Šæœ€æœ€æœ€è¯¦ç»†çš„æ‰‹å†™Promiseæ•™ç¨‹](https://juejin.cn/post/6844903625769091079)

## æ‰‹å†™new



```js
 	function myNew(fn, ...args) {
 Â  Â  Â // åˆ¤æ–­å‚æ•°æ˜¯å¦æ˜¯ä¸€ä¸ªå‡½æ•°
 Â  Â  Â if (typeof fn !== "function") {
 Â  Â  Â  Â return console.error("type error");
 Â  Â   }
 Â  Â  Â // åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶å°†å¯¹è±¡çš„åŸå‹ç»‘å®šåˆ°æ„é€ å‡½æ•°çš„åŸå‹ä¸Š
 Â  Â  Â const obj = Object.create(fn.prototype);
 Â  Â  Â const value = fn.apply(obj, args); // è°ƒç”¨æ„é€ å‡½æ•°ï¼Œå¹¶ä¸”thisç»‘å®šåˆ°objä¸Š
 Â  Â  Â // å¦‚æœæ„é€ å‡½æ•°æœ‰è¿”å›å€¼ï¼Œå¹¶ä¸”è¿”å›çš„æ˜¯å¯¹è±¡ï¼Œå°±è¿”å›value ;å¦åˆ™è¿”å›obj
 Â  Â  Â return value instanceof Object ? value : obj;
 Â   }
```



## Object.create

```js
function create(obj) {
 Â function F() {}
 Â F.prototype = obj
 Â return new F()
}
```



## ğŸ”¥æ‰‹å†™Array.map

```js
function mymap(arr,cb){
    let res = []
    if(Array.isArray(arr)&&arr.length&&typeof cb === 'function'){
        for(let i=0,i<arr.length;i++){
            res[i] = cb(arr[i],i,arr)
        }
    }
    return res
}
```



## call / apply / bind

```js
fn.call(obj,1,2,3) 
fn.apply(obj,[1,2,3])// å‚æ•°ä¸ºæ•°ç»„
fn.bind(obj,[1,2,3]) // å¹¶ä¸ç«‹å³æ‰§è¡Œ
```

ğŸ**åŒ**

- éƒ½æ˜¯functionåŸå‹ä¸Šçš„æ–¹æ³•

- éƒ½æ˜¯è°ƒç”¨å‡½æ•°

- éƒ½å¯ä»¥æ”¹å˜thisæŒ‡å‘

ğŸ**ä¸åŒ**

- apply æ¥æ”¶çš„å‚æ•°æ˜¯æ•°ç»„

**ğŸ“Œæ³¨æ„**

> call çš„æ€§èƒ½ä¼šæ¯”applyå¥½ä¸€ä¸¢ä¸¢(å°¤å…¶æ˜¯ä¼ å‚å¤§äº3ä¸ªçš„æ—¶å€™)
>
> bindå¹¶ä¸ç«‹å³æ‰§è¡Œ

### ğŸ”¥æ‰‹å†™call

```js
Function.prototype.myCall = function(context, ...args) {
  context = context || window
  let fn = Symbol()
  context[fn] = this
  let result = context[fn](...args)
  delete context[fn]
  return result
}
```



### ğŸ”¥æ‰‹å†™apply

```js
Function.prototype.myApply = function(context) {
  context = context || window
  let fn = Symbol()
  context[fn] = this
  let result
  if (arguments[1]) {
    result = context[fn](...arguments[1])
  } else {
    result = context[fn]()
  }
  delete context[fn]
  return result
}
```

### ğŸ”¥æ‰‹å†™bind

```js
Function.prototype.myBind = function (context) {
  var fn = this
  var args = [...arguments].slice(1)// ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯thisæŒ‡å‘
  // è¿”å›ä¸€ä¸ªå‡½æ•°
  return function F() {
    // å› ä¸ºè¿”å›äº†ä¸€ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ new F()ï¼Œæ‰€ä»¥éœ€è¦åˆ¤æ–­
    if (this instanceof F) {
      return new fn(...args, ...arguments)
    }
    return fn.apply(context, args.concat(...arguments))
  }
}
// ä½¿ç”¨
fn.myBind(obj,[1,2,3])
```

## ğŸ‘€instanceof

åŸç†:

```js
function instanceof(left, right) {
    // è·å¾—ç±»å‹çš„åŸå‹
    let prototype = right.prototype
    // è·å¾—å¯¹è±¡çš„åŸå‹
    left = left.__proto__
    // åˆ¤æ–­å¯¹è±¡çš„ç±»å‹æ˜¯å¦ç­‰äºç±»å‹çš„åŸå‹
    while (true) {
    	if (left === null)
    		return false
    	if (prototype === left)
    		return true
    	left = left.__proto__
    }
}
// instanceof({},Object)
```

## 